<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zach Palmore">
<meta name="dcterms.date" content="2022-08-28">

<title>Zachary Palmore - Time Series Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Zachary Palmore</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Time Series Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Predicting Value of Uncertain Variables</p>
                                <div class="quarto-categories">
                <div class="quarto-category">predictive</div>
                <div class="quarto-category">modeling</div>
                <div class="quarto-category">data science</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Zach Palmore </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 28, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#challenge" id="toc-challenge" class="nav-link active" data-scroll-target="#challenge">Challenge</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction">Prediction</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>A good forecast is a blessing while the wrong forecast could prove to be dangerous</p>
<p>View the full <a href="https://github.com/palmorezm/showcase/tree/master/posts/Stock%20Prediction">source code on GitHub</a>.</p>
<section id="challenge" class="level2">
<h2 class="anchored" data-anchor-id="challenge">Challenge</h2>
<p>Given stock value data source with several groups, we attempt to predict the next 140 values of a times series data set based on 1622 entries provided on multiple events. Our predictions will be fine-tuned to reduce the mean absolute percentage error (MAPE) as much as possible. The packages we will be using and all associated code to produce the models can be found in the attached markdown file. The data with its first five rows, are shown below.</p>
<div class="cell" data-hash="arima_cache/html/unnamed-chunk-2_3f62647b13cec38924aee01000903691">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data source</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/palmorezm/msds/main/Predictive%20Analytics/Projects/Project1/project1data.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data %&gt;% </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(SeriesInd = ï..SeriesInd) </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["SeriesInd"],"name":[1],"type":["int"],"align":["right"]},{"label":["group"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Var01"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Var02"],"name":[4],"type":["int"],"align":["right"]},{"label":["Var03"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Var05"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Var07"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"40669","2":"S03","3":"30.64286","4":"123432400","5":"30.34","6":"30.49","7":"30.57286","_rn_":"1"},{"1":"40669","2":"S02","3":"10.28000","4":"60855800","5":"10.05","6":"10.17","7":"10.28000","_rn_":"2"},{"1":"40669","2":"S01","3":"26.61000","4":"10369300","5":"25.89","6":"26.20","7":"26.01000","_rn_":"3"},{"1":"40669","2":"S06","3":"27.48000","4":"39335700","5":"26.82","6":"27.02","7":"27.32000","_rn_":"4"},{"1":"40669","2":"S05","3":"69.26000","4":"27809100","5":"68.19","6":"68.72","7":"69.15000","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We create forecasts for two preselected variables within each of six predetermined groups. These groups are denoted S01, S02, S03, S04, S05, and S06 respectively. There are five variables within each group that we have to work with. They are Var01, Var02, Var03, Var05, and Var07 respectively. Our date variable ‘SeriesInd,’ is displayed in its numeric serial number form calculated with Excel. Although we do not know what the variables stand for, we can develop models to try and forecast their behavior. This chart contains a breakdown of which variables are forecast in each group.</p>
<div class="cell" data-hash="arima_cache/html/unnamed-chunk-3_a2aee77d89dd2b17e2408e80fdb10628">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chart</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>varsbygroup <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"S01"</span>, <span class="st">"S02"</span>, <span class="st">"S03"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"S04"</span>, <span class="st">"S05"</span>, <span class="st">"S06"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var01"</span>, <span class="st">"Var02"</span>, <span class="st">"Var05"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var01"</span>, <span class="st">"Var02"</span>, <span class="st">"Var05"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var02"</span>, <span class="st">"Var03"</span>, <span class="st">"Var07"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var02"</span>, <span class="st">"Var03"</span>, <span class="st">"Var07"</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(varsbygroup) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>varsbygroup <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"HOLD_position"</span>, <span class="st">"scale_down"</span>), <span class="at">full_width =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Group </th>
   <th style="text-align:left;"> Variable1 </th>
   <th style="text-align:left;"> Variable2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> S01 </td>
   <td style="text-align:left;"> Var01 </td>
   <td style="text-align:left;"> Var02 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> S02 </td>
   <td style="text-align:left;"> Var02 </td>
   <td style="text-align:left;"> Var03 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> S03 </td>
   <td style="text-align:left;"> Var05 </td>
   <td style="text-align:left;"> Var07 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> S04 </td>
   <td style="text-align:left;"> Var01 </td>
   <td style="text-align:left;"> Var02 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> S05 </td>
   <td style="text-align:left;"> Var02 </td>
   <td style="text-align:left;"> Var03 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> S06 </td>
   <td style="text-align:left;"> Var05 </td>
   <td style="text-align:left;"> Var07 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>S01 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S01"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>S02 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S02"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>S03 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S03"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>S04 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S04"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>S05 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S05"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>S06 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S06"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation by function - missing something? lapply/sapply may work </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>soximp <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(df)){</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(df[[i]])) <span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      df[[i]][<span class="fu">is.na</span>(df[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(df[[i]], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation loops for each group by median </span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S01)){</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S01[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    S01[[i]][<span class="fu">is.na</span>(S01[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S01[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S02)){</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S02[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    S02[[i]][<span class="fu">is.na</span>(S02[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S02[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S03)){</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S03[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    S03[[i]][<span class="fu">is.na</span>(S03[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S03[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S04)){</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S04[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    S04[[i]][<span class="fu">is.na</span>(S04[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S04[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S05)){</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S05[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    S05[[i]][<span class="fu">is.na</span>(S05[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S05[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S06)){</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S06[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    S06[[i]][<span class="fu">is.na</span>(S06[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S06[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before we begin, the data is filtered to extract each time series by group. This isolates the Var01, Var02, Var03, Var05, and Var07 variables associated with groups S01, S02, and so on. Then, with each group and its respective variables’ behavior isolated, we clean and adjust the data to make use of it in the analysis. Once we determine the most appropriate models to forecast the proper variable in each group, we evaluate the results of our predictions. Our final forecasts are captured in the excel spreadsheet attached.</p>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<p>We began by addressing missing values. Given 10,572 observations, about 8% of each variable was missing. Several methods were tried to address this but the best were Kalman smoothing and simple imputation by the median of each ‘Var0X’ variable to fill in where appropriate. The ‘SeriesInd’ numeric date was also converted from its serial number form to a common date-time series. We then examined each group’s variables separately.</p>
<div class="cell" data-hash="arima_cache/html/unnamed-chunk-4_27625962b2afd75c13c15d8b97fc1a5b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(fpp2)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#S01</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>S01<span class="ot">&lt;-</span><span class="fu">subset</span>(data, group <span class="sc">==</span> <span class="st">"S01"</span>, <span class="at">select =</span> <span class="fu">c</span>(SeriesInd, Var01, Var02))<span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as.Date</span>(SeriesInd, <span class="at">origin =</span> <span class="st">"1905-01-01"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SeriesInd         Var01           Var02               date           
 Min.   :40669   Min.   :23.01   Min.   : 1339900   Min.   :2016-05-07  
 1st Qu.:41304   1st Qu.:29.85   1st Qu.: 5347550   1st Qu.:2018-01-31  
 Median :41946   Median :35.66   Median : 7895050   Median :2019-11-05  
 Mean   :41945   Mean   :39.41   Mean   : 8907092   Mean   :2019-11-03  
 3rd Qu.:42586   3rd Qu.:48.70   3rd Qu.:11321675   3rd Qu.:2021-08-06  
 Max.   :43221   Max.   :62.31   Max.   :48477500   Max.   :2023-05-03  
                 NA's   :142     NA's   :140                            </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset Var01 and Var02 from S01.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>S01_Var01<span class="ot">&lt;-</span>S01 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var01)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>S01_Var01<span class="ot">&lt;-</span>S01_Var01[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>S01_Var02<span class="ot">&lt;-</span>S01 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var02)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>S01_Var02<span class="ot">&lt;-</span>S01_Var02[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#S02</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>S02<span class="ot">&lt;-</span><span class="fu">subset</span>(data, group <span class="sc">==</span> <span class="st">"S02"</span>, <span class="at">select =</span> <span class="fu">c</span>(SeriesInd, Var02, Var03))<span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as.Date</span>(SeriesInd, <span class="at">origin =</span> <span class="st">"1905-01-01"</span>))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SeriesInd         Var02               Var03            date           
 Min.   :40669   Min.   :  7128800   Min.   : 8.82   Min.   :2016-05-07  
 1st Qu.:41304   1st Qu.: 27880300   1st Qu.:11.82   1st Qu.:2018-01-31  
 Median :41946   Median : 39767500   Median :13.76   Median :2019-11-05  
 Mean   :41945   Mean   : 50633098   Mean   :13.68   Mean   :2019-11-03  
 3rd Qu.:42586   3rd Qu.: 59050900   3rd Qu.:15.52   3rd Qu.:2021-08-06  
 Max.   :43221   Max.   :480879500   Max.   :38.28   Max.   :2023-05-03  
                 NA's   :140         NA's   :144                         </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset Var02 and Var03 from S02.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>S02_Var02<span class="ot">&lt;-</span>S02 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var02)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>S02_Var02<span class="ot">&lt;-</span>S02_Var02[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>S02_Var03<span class="ot">&lt;-</span>S02 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var03)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>S02_Var03<span class="ot">&lt;-</span>S02_Var03[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#S03</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>S03<span class="ot">&lt;-</span><span class="fu">subset</span>(data, group <span class="sc">==</span> <span class="st">"S03"</span>, <span class="at">select =</span> <span class="fu">c</span>(SeriesInd, Var05, Var07))<span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as.Date</span>(SeriesInd, <span class="at">origin =</span> <span class="st">"1905-01-01"</span>))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S03)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SeriesInd         Var05            Var07             date           
 Min.   :40669   Min.   : 27.48   Min.   : 27.44   Min.   :2016-05-07  
 1st Qu.:41304   1st Qu.: 53.30   1st Qu.: 53.46   1st Qu.:2018-01-31  
 Median :41946   Median : 75.59   Median : 75.71   Median :2019-11-05  
 Mean   :41945   Mean   : 76.90   Mean   : 76.87   Mean   :2019-11-03  
 3rd Qu.:42586   3rd Qu.: 98.55   3rd Qu.: 98.61   3rd Qu.:2021-08-06  
 Max.   :43221   Max.   :134.46   Max.   :133.00   Max.   :2023-05-03  
                 NA's   :144      NA's   :144                          </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset Var05 and Var07 from S03.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>S03_Var05<span class="ot">&lt;-</span>S03 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var05)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>S03_Var05<span class="ot">&lt;-</span>S03_Var05[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>S03_Var07<span class="ot">&lt;-</span>S03 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var07)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>S03_Var07<span class="ot">&lt;-</span>S03_Var07[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Statistical summaries, box plots, and histograms were run on each group to evaluate where the average value of each variable was, if its distribution was skewed, determine whether outliers were present, and provide other descriptors of the data. These informed us that the average value (mean) of the variables are similar but their range varies widely with Var05 at 186.01 while Var02 covers a range of 479 million. Our analysis solves this potential problem by focusing on variables of the same scales as the intended target.</p>
<div class="cell" data-hash="arima_cache/html/unnamed-chunk-6_836de3a48c46be37c92f2b1a9d91ff6d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01_Var01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  23.01   29.85   35.72   39.47   48.76   62.38 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S01_Var01)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S01_Var01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arima_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S01_Var01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arima_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Additionally, all but group S03 of the histograms exhibited right skewness, and Var02 and Var03 had outliers. These were replaced using Friedman’s super smoothing method. Due to the randomness of these variables, determining outliers was difficult and there is a presence of additional overly influential points as determined using Cook’s distance formula. We acknowledge the presence of these points but are unable to alter them as they are likely intentional based on the patterns in the data. For reference, the observations are shown in the scatter plot with color coding by each group.</p>
<div class="cell" data-hash="arima_cache/html/unnamed-chunk-7_beb6c22858d2fbd07d84f47dc3d4a8f3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]<span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(variable, value, <span class="sc">-</span>SeriesInd, <span class="sc">-</span>group) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(value, SeriesInd, <span class="at">color =</span> group)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">1</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">21</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variable Patterns"</span>, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Color Coded by Group"</span>, </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Value"</span>, </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Time"</span>, </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Contains all non-null observations of the given data set"</span>) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>), </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arima_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Seasonality was also considered. It is possible this data follows a weak seasonal trend that increases during summer months but there is not a lot of evidence to support regular fluctuations. Regular gaps were noticed in the time series on a weekly basis and several methods were used in attempts to fix this. However, the data appears randomly distributed and as such, acts randomly. For this reason, we left the gaps alone and any further adjustments made were minimal to avoid disturbing any existing patterns in the data.</p>
<p>We determined that the best model type was an Auto Regressive Integrated Moving Average (ARIMA) with drift. Unfortunately, all variables required differencing to achieve stationarity. This indicates that any predictions made with these variables may be unrealistic because of inherent random changes in statistics like the mean and variance of these variables over time. We transform the data in our attempts to achieve stationarity but it should be noted that our review of stationarity is only a rough estimate using the aforementioned summary statistics so that we may apply this ARIMA method. Otherwise, we would have to conclude this data is inherently unpredictable and as such, render model forecasts useless. Rather, we focus on forecasting each variable individually and try to keep it simple.</p>
</section>
<section id="prediction" class="level2">
<h2 class="anchored" data-anchor-id="prediction">Prediction</h2>
<p>When predicting stock values over time, we know that there is a great deal of uncertainty in the outcome. However, our results perform better than expected when individual stock values are isolated and modeled over time with greater weight given to recent historical data. Using our Auto Regressive Integrated Moving Average (ARIMA) with drift, the first set of stock values are show with a cone of uncertainty to note 95% and 80% confidence intervals the interval of time.</p>
<div class="cell" data-hash="arima_cache/html/unnamed-chunk-10_8d50e89a7c177d8250dcd03d2a93b7a6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0101)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arima_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These forecasts demonstrate how difficult it is to predict stocks values using day-value pairing. However, they also provide a clear estimation of the highest and lowest value points at a given day which can be an invaluable asset. These bounds around the estimated blue line show we should not expect values to go very far above 70 but they also are not likely to drop below 50 anytime soon. Of course, uncertainty grows the farther out our predictions are. Thus, the model must account for the growth in uncertainty over time to manage our risk. This trend is show in the chart below.</p>
<div class="cell" data-hash="arima_cache/html/unnamed-chunk-13_0fba48258250f550cb87ff25c2d656c3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fcast0101 <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>)))) <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">fill=</span><span class="st">"forest green"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="st">`</span><span class="at">Lo 80</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">Hi 80</span><span class="st">`</span>), <span class="at">fill=</span><span class="st">"dark green"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> b1, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> b2, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> b3, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b1, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b1, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b2, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b2, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b3, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b3, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b4, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b4, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, b1, b2, b3, b4)) <span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fu">min</span>(fcast0101<span class="sc">$</span>lower), <span class="fu">max</span>(fcast0101<span class="sc">$</span>upper)), </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">round</span>(fcast0101<span class="sc">$</span>mean[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>), </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>), </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>), </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span><span class="fl">53.9</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"MAPE ="</span>, <span class="fu">signif</span>(mape0101, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>txtx90,<span class="at">y=</span>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">3.50</span>, </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"95% Confidence"</span> ) <span class="sc">+</span> </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx90, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">4.75</span>, </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx90, </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>,</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx90, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">3</span>, </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx90, </span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>,</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span> </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>txtx80, <span class="at">y=</span>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span> <span class="sc">-</span> <span class="fl">3.01</span>, </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"80% Confidence"</span> ) <span class="sc">+</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx80, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">-</span> <span class="fl">1.75</span>, </span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx80, </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx80),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 80</span><span class="st">`</span>,</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx80, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">-</span><span class="fl">3.5</span>, </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx80, </span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx80),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 80</span><span class="st">`</span>,</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>b1 <span class="sc">-</span> <span class="fl">7.05</span>, <span class="at">y=</span><span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">6</span>, </span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Day 15:"</span>, <span class="fu">signif</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> b1 <span class="sc">-</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">5</span>, </span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>,</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> b1, </span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>)))  <span class="sc">+</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>b2 <span class="sc">-</span> <span class="dv">5</span>, <span class="at">y=</span><span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">9</span>, </span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Day 30:"</span>, <span class="fu">signif</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> b2 <span class="sc">-</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">8.0</span>, </span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>,</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> b2, </span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>)))  <span class="sc">+</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>b3 <span class="sc">-</span> <span class="dv">10</span>, <span class="at">y=</span><span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">11</span>, </span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Day 60:"</span>, <span class="fu">signif</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> b3 <span class="sc">-</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">9.75</span>, </span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>,</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> b3, </span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, </span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Value Estimation is Less Certain with Time"</span>, </span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Stock Market Day-Value Pairs over 100 Days Shows Growth of Uncertainty"</span>) <span class="sc">+</span> </span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>                          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arima_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>View the full <a href="https://github.com/palmorezm/showcase/tree/master/posts/Stock%20Prediction">source code on GitHub</a>.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb18" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Time Series Analysis"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Predicting Value of Uncertain Variables"</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Zach Palmore"</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2022-08-28"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [predictive, modeling, data science]</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "bullversusbear_image.svg"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: pygments</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method: katex</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">    cache: true</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">      light: flatly</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">      dark: darkly</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">include=</span>T, <span class="at">echo =</span> F, <span class="at">warning=</span>F, <span class="at">message=</span>F)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>A good forecast is a blessing while the wrong forecast could prove to be dangerous</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>View the full <span class="co">[</span><span class="ot">source code on GitHub</span><span class="co">](https://github.com/palmorezm/showcase/tree/master/posts/Stock%20Prediction)</span>.</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Challenge</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>Given stock value data source with several groups, we attempt to predict the next 140 values of a times series data set based on 1622 entries provided on multiple events. Our predictions will be fine-tuned to reduce the mean absolute percentage error (MAPE) as much as possible. The packages we will be using and all associated code to produce the models can be found in the attached markdown file. The data with its first five rows, are shown below.</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imputeTS)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsoutliers)</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Data source</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/palmorezm/msds/main/Predictive%20Analytics/Projects/Project1/project1data.csv"</span>)</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data %&gt;% </span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(SeriesInd = ï..SeriesInd) </span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data, <span class="dv">5</span>)</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>We create forecasts for two preselected variables within each of six predetermined groups. These groups are denoted S01, S02, S03, S04, S05, and S06 respectively. There are five variables within each group that we have to work with. They are Var01, Var02, Var03, Var05, and Var07 respectively. Our date variable 'SeriesInd,' is displayed in its numeric serial number form calculated with Excel. Although we do not know what the variables stand for, we can develop models to try and forecast their behavior. This chart contains a breakdown of which variables are forecast in each group.</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Chart</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>varsbygroup <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"S01"</span>, <span class="st">"S02"</span>, <span class="st">"S03"</span>,</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"S04"</span>, <span class="st">"S05"</span>, <span class="st">"S06"</span>, </span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var01"</span>, <span class="st">"Var02"</span>, <span class="st">"Var05"</span>,</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var01"</span>, <span class="st">"Var02"</span>, <span class="st">"Var05"</span>,</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var02"</span>, <span class="st">"Var03"</span>, <span class="st">"Var07"</span>,</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Var02"</span>, <span class="st">"Var03"</span>, <span class="st">"Var07"</span>),</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(varsbygroup) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>)</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>varsbygroup <span class="sc">%&gt;%</span> </span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"HOLD_position"</span>, <span class="st">"scale_down"</span>), <span class="at">full_width =</span> T)</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>S01 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S01"</span>)</span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>S02 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S02"</span>)</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>S03 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S03"</span>)</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>S04 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S04"</span>)</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>S05 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S05"</span>)</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>S06 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"S06"</span>)</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation by function - missing something? lapply/sapply may work </span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>soximp <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(df)){</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(df[[i]])) <span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>      df[[i]][<span class="fu">is.na</span>(df[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(df[[i]], <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation loops for each group by median </span></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S01)){</span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S01[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>    S01[[i]][<span class="fu">is.na</span>(S01[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S01[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S02)){</span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S02[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>    S02[[i]][<span class="fu">is.na</span>(S02[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S02[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S03)){</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S03[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>    S03[[i]][<span class="fu">is.na</span>(S03[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S03[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S04)){</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S04[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>    S04[[i]][<span class="fu">is.na</span>(S04[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S04[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S05)){</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S05[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>    S05[[i]][<span class="fu">is.na</span>(S05[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S05[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(S06)){</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(S06[[i]])) <span class="sc">!=</span> <span class="dv">0</span>){</span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>    S06[[i]][<span class="fu">is.na</span>(S06[[i]])] <span class="ot">&lt;-</span> <span class="fu">median</span>(S06[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>Before we begin, the data is filtered to extract each time series by group. This isolates the Var01, Var02, Var03, Var05, and Var07 variables associated with groups S01, S02, and so on. Then, with each group and its respective variables' behavior isolated, we clean and adjust the data to make use of it in the analysis. Once we determine the most appropriate models to forecast the proper variable in each group, we evaluate the results of our predictions. Our final forecasts are captured in the excel spreadsheet attached.</span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysis</span></span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>We began by addressing missing values. Given 10,572 observations, about 8% of each variable was missing. Several methods were tried to address this but the best were Kalman smoothing and simple imputation by the median of each 'Var0X' variable to fill in where appropriate. The 'SeriesInd' numeric date was also converted from its serial number form to a common date-time series. We then examined each group's variables separately.</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a><span class="co"># library(fpp2)</span></span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a><span class="co">#S01</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>S01<span class="ot">&lt;-</span><span class="fu">subset</span>(data, group <span class="sc">==</span> <span class="st">"S01"</span>, <span class="at">select =</span> <span class="fu">c</span>(SeriesInd, Var01, Var02))<span class="sc">%&gt;%</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as.Date</span>(SeriesInd, <span class="at">origin =</span> <span class="st">"1905-01-01"</span>))</span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01)</span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset Var01 and Var02 from S01.</span></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a>S01_Var01<span class="ot">&lt;-</span>S01 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var01)</span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a>S01_Var01<span class="ot">&lt;-</span>S01_Var01[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>S01_Var02<span class="ot">&lt;-</span>S01 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var02)</span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>S01_Var02<span class="ot">&lt;-</span>S01_Var02[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a><span class="co">#S02</span></span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a>S02<span class="ot">&lt;-</span><span class="fu">subset</span>(data, group <span class="sc">==</span> <span class="st">"S02"</span>, <span class="at">select =</span> <span class="fu">c</span>(SeriesInd, Var02, Var03))<span class="sc">%&gt;%</span></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as.Date</span>(SeriesInd, <span class="at">origin =</span> <span class="st">"1905-01-01"</span>))</span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S02)</span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset Var02 and Var03 from S02.</span></span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>S02_Var02<span class="ot">&lt;-</span>S02 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var02)</span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>S02_Var02<span class="ot">&lt;-</span>S02_Var02[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a>S02_Var03<span class="ot">&lt;-</span>S02 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var03)</span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>S02_Var03<span class="ot">&lt;-</span>S02_Var03[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a><span class="co">#S03</span></span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a>S03<span class="ot">&lt;-</span><span class="fu">subset</span>(data, group <span class="sc">==</span> <span class="st">"S03"</span>, <span class="at">select =</span> <span class="fu">c</span>(SeriesInd, Var05, Var07))<span class="sc">%&gt;%</span></span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as.Date</span>(SeriesInd, <span class="at">origin =</span> <span class="st">"1905-01-01"</span>))</span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S03)</span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset Var05 and Var07 from S03.</span></span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a>S03_Var05<span class="ot">&lt;-</span>S03 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var05)</span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a>S03_Var05<span class="ot">&lt;-</span>S03_Var05[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a>S03_Var07<span class="ot">&lt;-</span>S03 <span class="sc">%&gt;%</span><span class="fu">select</span>(Var07)</span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a>S03_Var07<span class="ot">&lt;-</span>S03_Var07[<span class="dv">1</span><span class="sc">:</span><span class="dv">1625</span>,]</span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a>Statistical summaries, box plots, and histograms were run on each group to evaluate where the average value of each variable was, if its distribution was skewed, determine whether outliers were present, and provide other descriptors of the data. These informed us that the average value (mean) of the variables are similar but their range varies widely with Var05 at 186.01 while Var02 covers a range of 479 million. Our analysis solves this potential problem by focusing on variables of the same scales as the intended target.</span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a><span class="co"># library(imputeTS)</span></span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the subset data.</span></span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01_Var01)</span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01_Var02)</span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S02_Var02)</span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S02_Var03)</span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S03_Var07)</span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S03_Var05)</span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a><span class="co"># according to the summary of subsets, </span></span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a><span class="co"># S01_Var01 has 5 NAs</span></span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a><span class="co"># S01_Var02 has 3 NAs</span></span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a><span class="co"># S02_Var02 has 3 NAs</span></span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a><span class="co"># S02_Var03 has 7 NAs</span></span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a><span class="co"># S03_Var07 has 7 NAs</span></span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a><span class="co"># S03_Var05 has 7 NAs</span></span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Kalman Smoothing to impute NAs.</span></span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a>S01_Var01<span class="ot">&lt;-</span><span class="fu">na_kalman</span>(S01_Var01)</span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a>S01_Var02<span class="ot">&lt;-</span><span class="fu">na_kalman</span>(S01_Var02)</span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a>S02_Var02<span class="ot">&lt;-</span><span class="fu">na_kalman</span>(S02_Var02)</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a>S02_Var03<span class="ot">&lt;-</span><span class="fu">na_kalman</span>(S02_Var03)</span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a>S03_Var05<span class="ot">&lt;-</span><span class="fu">na_kalman</span>(S03_Var05)</span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a>S03_Var07<span class="ot">&lt;-</span><span class="fu">na_kalman</span>(S03_Var07)</span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01_Var01)</span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01_Var02)</span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S02_Var02)</span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S02_Var03)</span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S03_Var07)</span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S03_Var05)</span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a><span class="co"># NA  no longer exists</span></span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a>ts_S01_Var01<span class="ot">&lt;-</span><span class="fu">ts</span>(S01_Var01)</span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a>ts_S01_Var02<span class="ot">&lt;-</span><span class="fu">ts</span>(S01_Var02)</span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a>ts_S02_Var02<span class="ot">&lt;-</span><span class="fu">ts</span>(S02_Var02)</span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a>ts_S02_Var03<span class="ot">&lt;-</span><span class="fu">ts</span>(S02_Var03)</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a>ts_S03_Var05<span class="ot">&lt;-</span><span class="fu">ts</span>(S03_Var05)</span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a>ts_S03_Var07<span class="ot">&lt;-</span><span class="fu">ts</span>(S03_Var07)</span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ts_S01_Var01)</span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ts_S01_Var02)</span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ts_S02_Var02)</span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ts_S02_Var03)</span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ts_S03_Var05)</span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ts_S03_Var07)</span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S01_Var01)</span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S01_Var02)</span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S02_Var02)</span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S02_Var03)</span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S03_Var05)</span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S03_Var07)</span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S01_Var01)</span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S01_Var01)</span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S01_Var02)</span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S01_Var02)</span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S02_Var02)</span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S02_Var02)</span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S02_Var03)</span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S02_Var03)</span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-272"><a href="#cb18-272" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-273"><a href="#cb18-273" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S03_Var05)</span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S03_Var05)</span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-276"><a href="#cb18-276" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-277"><a href="#cb18-277" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S03_Var07)</span>
<span id="cb18-278"><a href="#cb18-278" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S03_Var07)</span>
<span id="cb18-279"><a href="#cb18-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-280"><a href="#cb18-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-283"><a href="#cb18-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-284"><a href="#cb18-284" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(S01_Var01)</span>
<span id="cb18-285"><a href="#cb18-285" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-286"><a href="#cb18-286" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts_S01_Var01)</span>
<span id="cb18-287"><a href="#cb18-287" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_S01_Var01)</span>
<span id="cb18-288"><a href="#cb18-288" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(ts_S01_Var01)</span>
<span id="cb18-289"><a href="#cb18-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-290"><a href="#cb18-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-291"><a href="#cb18-291" aria-hidden="true" tabindex="-1"></a>Additionally, all but group S03 of the histograms exhibited right skewness, and Var02 and Var03 had outliers. These were replaced using Friedman's super smoothing method. Due to the randomness of these variables, determining outliers was difficult and there is a presence of additional overly influential points as determined using Cook's distance formula. We acknowledge the presence of these points but are unable to alter them as they are likely intentional based on the patterns in the data. For reference, the observations are shown in the scatter plot with color coding by each group.</span>
<span id="cb18-292"><a href="#cb18-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-295"><a href="#cb18-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-296"><a href="#cb18-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb18-297"><a href="#cb18-297" aria-hidden="true" tabindex="-1"></a>data[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]<span class="sc">%&gt;%</span></span>
<span id="cb18-298"><a href="#cb18-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(variable, value, <span class="sc">-</span>SeriesInd, <span class="sc">-</span>group) <span class="sc">%&gt;%</span></span>
<span id="cb18-299"><a href="#cb18-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(value, SeriesInd, <span class="at">color =</span> group)) <span class="sc">+</span> </span>
<span id="cb18-300"><a href="#cb18-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb18-301"><a href="#cb18-301" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">1</span>, </span>
<span id="cb18-302"><a href="#cb18-302" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape=</span><span class="dv">21</span>, </span>
<span id="cb18-303"><a href="#cb18-303" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb18-304"><a href="#cb18-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb18-305"><a href="#cb18-305" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, </span>
<span id="cb18-306"><a href="#cb18-306" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb18-307"><a href="#cb18-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variable Patterns"</span>, </span>
<span id="cb18-308"><a href="#cb18-308" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Color Coded by Group"</span>, </span>
<span id="cb18-309"><a href="#cb18-309" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Value"</span>, </span>
<span id="cb18-310"><a href="#cb18-310" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Time"</span>, </span>
<span id="cb18-311"><a href="#cb18-311" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Contains all non-null observations of the given data set"</span>) <span class="sc">+</span></span>
<span id="cb18-312"><a href="#cb18-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-313"><a href="#cb18-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>), </span>
<span id="cb18-314"><a href="#cb18-314" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb18-315"><a href="#cb18-315" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb18-316"><a href="#cb18-316" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-317"><a href="#cb18-317" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), </span>
<span id="cb18-318"><a href="#cb18-318" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>)</span>
<span id="cb18-319"><a href="#cb18-319" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-320"><a href="#cb18-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-321"><a href="#cb18-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-322"><a href="#cb18-322" aria-hidden="true" tabindex="-1"></a>Seasonality was also considered. It is possible this data follows a weak seasonal trend that increases during summer months but there is not a lot of evidence to support regular fluctuations. Regular gaps were noticed in the time series on a weekly basis and several methods were used in attempts to fix this. However, the data appears randomly distributed and as such, acts randomly. For this reason, we left the gaps alone and any further adjustments made were minimal to avoid disturbing any existing patterns in the data.</span>
<span id="cb18-323"><a href="#cb18-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-326"><a href="#cb18-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-327"><a href="#cb18-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-328"><a href="#cb18-328" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(ts_S01_Var01)</span>
<span id="cb18-329"><a href="#cb18-329" aria-hidden="true" tabindex="-1"></a>ts_S01_Var01<span class="sc">%&gt;%</span><span class="fu">diff</span>()<span class="sc">%&gt;%</span><span class="fu">ndiffs</span>()</span>
<span id="cb18-330"><a href="#cb18-330" aria-hidden="true" tabindex="-1"></a><span class="co"># ndiffs test for ts_S01_Var02.</span></span>
<span id="cb18-331"><a href="#cb18-331" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(ts_S01_Var02)</span>
<span id="cb18-332"><a href="#cb18-332" aria-hidden="true" tabindex="-1"></a>ts_S01_Var02<span class="sc">%&gt;%</span><span class="fu">diff</span>()<span class="sc">%&gt;%</span><span class="fu">ndiffs</span>()</span>
<span id="cb18-333"><a href="#cb18-333" aria-hidden="true" tabindex="-1"></a><span class="co"># ndiffs test for ts_S02_Var02</span></span>
<span id="cb18-334"><a href="#cb18-334" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(ts_S02_Var02)</span>
<span id="cb18-335"><a href="#cb18-335" aria-hidden="true" tabindex="-1"></a>ts_S02_Var02<span class="sc">%&gt;%</span><span class="fu">diff</span>()<span class="sc">%&gt;%</span><span class="fu">ndiffs</span>()</span>
<span id="cb18-336"><a href="#cb18-336" aria-hidden="true" tabindex="-1"></a><span class="co"># ndiffs test for ts_S02_Var03.</span></span>
<span id="cb18-337"><a href="#cb18-337" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(ts_S02_Var03)</span>
<span id="cb18-338"><a href="#cb18-338" aria-hidden="true" tabindex="-1"></a>ts_S02_Var02<span class="sc">%&gt;%</span><span class="fu">diff</span>()<span class="sc">%&gt;%</span><span class="fu">ndiffs</span>()</span>
<span id="cb18-339"><a href="#cb18-339" aria-hidden="true" tabindex="-1"></a><span class="co"># ndiffs test for ts_S03_Var05.</span></span>
<span id="cb18-340"><a href="#cb18-340" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(ts_S03_Var05)</span>
<span id="cb18-341"><a href="#cb18-341" aria-hidden="true" tabindex="-1"></a>ts_S03_Var05<span class="sc">%&gt;%</span><span class="fu">diff</span>()<span class="sc">%&gt;%</span><span class="fu">ndiffs</span>()</span>
<span id="cb18-342"><a href="#cb18-342" aria-hidden="true" tabindex="-1"></a><span class="co"># ndiffs test for ts_S03_Var07.</span></span>
<span id="cb18-343"><a href="#cb18-343" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(ts_S03_Var07)</span>
<span id="cb18-344"><a href="#cb18-344" aria-hidden="true" tabindex="-1"></a>ts_S03_Var07<span class="sc">%&gt;%</span><span class="fu">diff</span>()<span class="sc">%&gt;%</span><span class="fu">ndiffs</span>()</span>
<span id="cb18-345"><a href="#cb18-345" aria-hidden="true" tabindex="-1"></a><span class="co"># According to the ndiffs test, all the variables above require difference.</span></span>
<span id="cb18-346"><a href="#cb18-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-347"><a href="#cb18-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-348"><a href="#cb18-348" aria-hidden="true" tabindex="-1"></a>We determined that the best model type was an Auto Regressive Integrated Moving Average (ARIMA) with drift. Unfortunately, all variables required differencing to achieve stationarity. This indicates that any predictions made with these variables may be unrealistic because of inherent random changes in statistics like the mean and variance of these variables over time. We transform the data in our attempts to achieve stationarity but it should be noted that our review of stationarity is only a rough estimate using the aforementioned summary statistics so that we may apply this ARIMA method. Otherwise, we would have to conclude this data is inherently unpredictable and as such, render model forecasts useless. Rather, we focus on forecasting each variable individually and try to keep it simple.</span>
<span id="cb18-349"><a href="#cb18-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-350"><a href="#cb18-350" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction</span></span>
<span id="cb18-351"><a href="#cb18-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-352"><a href="#cb18-352" aria-hidden="true" tabindex="-1"></a>When predicting stock values over time, we know that there is a great deal of uncertainty in the outcome. However, our results perform better than expected when individual stock values are isolated and modeled over time with greater weight given to recent historical data. Using our Auto Regressive Integrated Moving Average (ARIMA) with drift, the first set of stock values are show with a cone of uncertainty to note 95% and 80% confidence intervals the interval of time.</span>
<span id="cb18-353"><a href="#cb18-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-356"><a href="#cb18-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-357"><a href="#cb18-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-358"><a href="#cb18-358" aria-hidden="true" tabindex="-1"></a>train0101<span class="ot">&lt;-</span><span class="fu">window</span>(ts_S01_Var01, <span class="at">end=</span><span class="fu">as.integer</span>(<span class="fu">length</span>(ts_S01_Var01)<span class="sc">*</span><span class="fl">0.7</span>))</span>
<span id="cb18-359"><a href="#cb18-359" aria-hidden="true" tabindex="-1"></a>train0102<span class="ot">&lt;-</span><span class="fu">window</span>(ts_S01_Var02, <span class="at">end=</span><span class="fu">as.integer</span>(<span class="fu">length</span>(ts_S01_Var02)<span class="sc">*</span><span class="fl">0.7</span>))</span>
<span id="cb18-360"><a href="#cb18-360" aria-hidden="true" tabindex="-1"></a>train0202<span class="ot">&lt;-</span><span class="fu">window</span>(ts_S02_Var02, <span class="at">end=</span><span class="fu">as.integer</span>(<span class="fu">length</span>(ts_S02_Var02)<span class="sc">*</span><span class="fl">0.7</span>))</span>
<span id="cb18-361"><a href="#cb18-361" aria-hidden="true" tabindex="-1"></a>train0203<span class="ot">&lt;-</span><span class="fu">window</span>(ts_S02_Var03, <span class="at">end=</span><span class="fu">as.integer</span>(<span class="fu">length</span>(ts_S02_Var03)<span class="sc">*</span><span class="fl">0.7</span>))</span>
<span id="cb18-362"><a href="#cb18-362" aria-hidden="true" tabindex="-1"></a>train0305<span class="ot">&lt;-</span><span class="fu">window</span>(ts_S03_Var05, <span class="at">end=</span><span class="fu">as.integer</span>(<span class="fu">length</span>(ts_S03_Var05)<span class="sc">*</span><span class="fl">0.7</span>))</span>
<span id="cb18-363"><a href="#cb18-363" aria-hidden="true" tabindex="-1"></a>train0307<span class="ot">&lt;-</span><span class="fu">window</span>(ts_S03_Var07, <span class="at">end=</span><span class="fu">as.integer</span>(<span class="fu">length</span>(ts_S03_Var07)<span class="sc">*</span><span class="fl">0.7</span>))</span>
<span id="cb18-364"><a href="#cb18-364" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ts_S01_Var01)<span class="sc">*</span><span class="fl">0.3</span></span>
<span id="cb18-365"><a href="#cb18-365" aria-hidden="true" tabindex="-1"></a><span class="co"># library(dplyr)</span></span>
<span id="cb18-366"><a href="#cb18-366" aria-hidden="true" tabindex="-1"></a><span class="co"># library(forecast)</span></span>
<span id="cb18-367"><a href="#cb18-367" aria-hidden="true" tabindex="-1"></a>AA_fit0101 <span class="ot">&lt;-</span> train0101 <span class="sc">%&gt;%</span> <span class="fu">auto.arima</span>(<span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span><span class="cn">FALSE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">488</span>)</span>
<span id="cb18-368"><a href="#cb18-368" aria-hidden="true" tabindex="-1"></a>AA_fit0102 <span class="ot">&lt;-</span> train0102 <span class="sc">%&gt;%</span> <span class="fu">auto.arima</span>(<span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span><span class="cn">FALSE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">488</span>)</span>
<span id="cb18-369"><a href="#cb18-369" aria-hidden="true" tabindex="-1"></a>AA_fit0202 <span class="ot">&lt;-</span> train0202 <span class="sc">%&gt;%</span> <span class="fu">auto.arima</span>(<span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span><span class="cn">FALSE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">488</span>)</span>
<span id="cb18-370"><a href="#cb18-370" aria-hidden="true" tabindex="-1"></a>AA_fit0203 <span class="ot">&lt;-</span> train0203 <span class="sc">%&gt;%</span> <span class="fu">auto.arima</span>(<span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span><span class="cn">FALSE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">488</span>)</span>
<span id="cb18-371"><a href="#cb18-371" aria-hidden="true" tabindex="-1"></a>AA_fit0305 <span class="ot">&lt;-</span> train0305 <span class="sc">%&gt;%</span> <span class="fu">auto.arima</span>(<span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span><span class="cn">FALSE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">488</span>)</span>
<span id="cb18-372"><a href="#cb18-372" aria-hidden="true" tabindex="-1"></a>AA_fit0307 <span class="ot">&lt;-</span> train0307 <span class="sc">%&gt;%</span> <span class="fu">auto.arima</span>(<span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span><span class="cn">FALSE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">488</span>)</span>
<span id="cb18-373"><a href="#cb18-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-374"><a href="#cb18-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-375"><a href="#cb18-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-376"><a href="#cb18-376" aria-hidden="true" tabindex="-1"></a>mape0101<span class="ot">&lt;-</span><span class="fu">accuracy</span>(AA_fit0101,ts_S01_Var01)[<span class="st">"Test set"</span>, <span class="st">"MAPE"</span>]</span>
<span id="cb18-377"><a href="#cb18-377" aria-hidden="true" tabindex="-1"></a>mape0101</span>
<span id="cb18-378"><a href="#cb18-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-379"><a href="#cb18-379" aria-hidden="true" tabindex="-1"></a>mape0102<span class="ot">&lt;-</span><span class="fu">accuracy</span>(AA_fit0102,ts_S01_Var02)[<span class="st">"Test set"</span>,<span class="st">"MAPE"</span>]</span>
<span id="cb18-380"><a href="#cb18-380" aria-hidden="true" tabindex="-1"></a>mape0102</span>
<span id="cb18-381"><a href="#cb18-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-382"><a href="#cb18-382" aria-hidden="true" tabindex="-1"></a>mape0202<span class="ot">&lt;-</span><span class="fu">accuracy</span>(AA_fit0202,ts_S02_Var02)[<span class="st">"Test set"</span>, <span class="st">"MAPE"</span>]</span>
<span id="cb18-383"><a href="#cb18-383" aria-hidden="true" tabindex="-1"></a>mape0202</span>
<span id="cb18-384"><a href="#cb18-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-385"><a href="#cb18-385" aria-hidden="true" tabindex="-1"></a>mape0203<span class="ot">&lt;-</span><span class="fu">accuracy</span>(AA_fit0203,ts_S02_Var03)[<span class="st">"Test set"</span>, <span class="st">"MAPE"</span>]</span>
<span id="cb18-386"><a href="#cb18-386" aria-hidden="true" tabindex="-1"></a>mape0203</span>
<span id="cb18-387"><a href="#cb18-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-388"><a href="#cb18-388" aria-hidden="true" tabindex="-1"></a>mape0305<span class="ot">&lt;-</span><span class="fu">accuracy</span>(AA_fit0305,ts_S03_Var05)[<span class="st">"Test set"</span>, <span class="st">"MAPE"</span>]</span>
<span id="cb18-389"><a href="#cb18-389" aria-hidden="true" tabindex="-1"></a>mape0101</span>
<span id="cb18-390"><a href="#cb18-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-391"><a href="#cb18-391" aria-hidden="true" tabindex="-1"></a>mape0307<span class="ot">&lt;-</span><span class="fu">accuracy</span>(AA_fit0307,ts_S03_Var07)[<span class="st">"Test set"</span>, <span class="st">"MAPE"</span>]</span>
<span id="cb18-392"><a href="#cb18-392" aria-hidden="true" tabindex="-1"></a>mape0307</span>
<span id="cb18-393"><a href="#cb18-393" aria-hidden="true" tabindex="-1"></a>AA0101<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(ts_S01_Var01, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F, <span class="at">seasonal =</span> T)</span>
<span id="cb18-394"><a href="#cb18-394" aria-hidden="true" tabindex="-1"></a>fcast0101<span class="ot">&lt;-</span><span class="fu">forecast</span>(AA0101,<span class="at">h=</span><span class="dv">140</span>)</span>
<span id="cb18-395"><a href="#cb18-395" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0101)</span>
<span id="cb18-396"><a href="#cb18-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-397"><a href="#cb18-397" aria-hidden="true" tabindex="-1"></a>AA0102<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(ts_S01_Var02, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F, <span class="at">seasonal =</span> T)</span>
<span id="cb18-398"><a href="#cb18-398" aria-hidden="true" tabindex="-1"></a>fcast0102<span class="ot">&lt;-</span><span class="fu">forecast</span>(AA0102,<span class="at">h=</span><span class="dv">140</span>)</span>
<span id="cb18-399"><a href="#cb18-399" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0102)</span>
<span id="cb18-400"><a href="#cb18-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-401"><a href="#cb18-401" aria-hidden="true" tabindex="-1"></a>AA0202<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(ts_S02_Var02, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F, <span class="at">seasonal =</span> T)</span>
<span id="cb18-402"><a href="#cb18-402" aria-hidden="true" tabindex="-1"></a>fcast0202<span class="ot">&lt;-</span><span class="fu">forecast</span>(AA0202,<span class="at">h=</span><span class="dv">140</span>)</span>
<span id="cb18-403"><a href="#cb18-403" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0202)</span>
<span id="cb18-404"><a href="#cb18-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-405"><a href="#cb18-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-406"><a href="#cb18-406" aria-hidden="true" tabindex="-1"></a>AA0203<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(ts_S02_Var03, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F, <span class="at">seasonal =</span> T)</span>
<span id="cb18-407"><a href="#cb18-407" aria-hidden="true" tabindex="-1"></a>fcast0203<span class="ot">&lt;-</span><span class="fu">forecast</span>(AA0203,<span class="at">h=</span><span class="dv">140</span>)</span>
<span id="cb18-408"><a href="#cb18-408" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0203)</span>
<span id="cb18-409"><a href="#cb18-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-410"><a href="#cb18-410" aria-hidden="true" tabindex="-1"></a>AA0305<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(ts_S03_Var05, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F, <span class="at">seasonal =</span> T)</span>
<span id="cb18-411"><a href="#cb18-411" aria-hidden="true" tabindex="-1"></a>fcast0305<span class="ot">&lt;-</span><span class="fu">forecast</span>(AA0305,<span class="at">h=</span><span class="dv">140</span>)</span>
<span id="cb18-412"><a href="#cb18-412" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0305)</span>
<span id="cb18-413"><a href="#cb18-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-414"><a href="#cb18-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-415"><a href="#cb18-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-416"><a href="#cb18-416" aria-hidden="true" tabindex="-1"></a>AA0307<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(ts_S03_Var07, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F, <span class="at">seasonal =</span> T)</span>
<span id="cb18-417"><a href="#cb18-417" aria-hidden="true" tabindex="-1"></a>fcast0307<span class="ot">&lt;-</span><span class="fu">forecast</span>(AA0307,<span class="at">h=</span><span class="dv">140</span>)</span>
<span id="cb18-418"><a href="#cb18-418" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0307)</span>
<span id="cb18-419"><a href="#cb18-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-420"><a href="#cb18-420" aria-hidden="true" tabindex="-1"></a>fcast0101</span>
<span id="cb18-421"><a href="#cb18-421" aria-hidden="true" tabindex="-1"></a>fcast0102</span>
<span id="cb18-422"><a href="#cb18-422" aria-hidden="true" tabindex="-1"></a>fcast0202</span>
<span id="cb18-423"><a href="#cb18-423" aria-hidden="true" tabindex="-1"></a>fcast0203</span>
<span id="cb18-424"><a href="#cb18-424" aria-hidden="true" tabindex="-1"></a>fcast0305</span>
<span id="cb18-425"><a href="#cb18-425" aria-hidden="true" tabindex="-1"></a>fcast0307</span>
<span id="cb18-426"><a href="#cb18-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-427"><a href="#cb18-427" aria-hidden="true" tabindex="-1"></a>S0101 <span class="ot">&lt;-</span> fcast0101<span class="sc">$</span>mean</span>
<span id="cb18-428"><a href="#cb18-428" aria-hidden="true" tabindex="-1"></a>S0102 <span class="ot">&lt;-</span> fcast0102<span class="sc">$</span>mean</span>
<span id="cb18-429"><a href="#cb18-429" aria-hidden="true" tabindex="-1"></a>S0202 <span class="ot">&lt;-</span> fcast0202<span class="sc">$</span>mean</span>
<span id="cb18-430"><a href="#cb18-430" aria-hidden="true" tabindex="-1"></a>S0203 <span class="ot">&lt;-</span> fcast0203<span class="sc">$</span>mean</span>
<span id="cb18-431"><a href="#cb18-431" aria-hidden="true" tabindex="-1"></a>S0305 <span class="ot">&lt;-</span> fcast0305<span class="sc">$</span>mean</span>
<span id="cb18-432"><a href="#cb18-432" aria-hidden="true" tabindex="-1"></a>S0307 <span class="ot">&lt;-</span> fcast0307<span class="sc">$</span>mean</span>
<span id="cb18-433"><a href="#cb18-433" aria-hidden="true" tabindex="-1"></a>S0101_preds <span class="ot">&lt;-</span> S0101[<span class="dv">1</span><span class="sc">:</span><span class="dv">140</span>]</span>
<span id="cb18-434"><a href="#cb18-434" aria-hidden="true" tabindex="-1"></a>S0102_preds <span class="ot">&lt;-</span> S0102[<span class="dv">1</span><span class="sc">:</span><span class="dv">140</span>]</span>
<span id="cb18-435"><a href="#cb18-435" aria-hidden="true" tabindex="-1"></a>S0202_preds <span class="ot">&lt;-</span> S0202[<span class="dv">1</span><span class="sc">:</span><span class="dv">140</span>]</span>
<span id="cb18-436"><a href="#cb18-436" aria-hidden="true" tabindex="-1"></a>S0203_preds <span class="ot">&lt;-</span> S0203[<span class="dv">1</span><span class="sc">:</span><span class="dv">140</span>]</span>
<span id="cb18-437"><a href="#cb18-437" aria-hidden="true" tabindex="-1"></a>S0305_preds <span class="ot">&lt;-</span> S0305[<span class="dv">1</span><span class="sc">:</span><span class="dv">140</span>]</span>
<span id="cb18-438"><a href="#cb18-438" aria-hidden="true" tabindex="-1"></a>S0307_preds <span class="ot">&lt;-</span> S0307[<span class="dv">1</span><span class="sc">:</span><span class="dv">140</span>]</span>
<span id="cb18-439"><a href="#cb18-439" aria-hidden="true" tabindex="-1"></a>csv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(S0101_preds, S0102_preds, S0202_preds, S0203_preds,S0305_preds, S0307_preds))</span>
<span id="cb18-440"><a href="#cb18-440" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(csv, file = "C:/data/csv.csv")</span></span>
<span id="cb18-441"><a href="#cb18-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-442"><a href="#cb18-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-445"><a href="#cb18-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-446"><a href="#cb18-446" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fcast0101)</span>
<span id="cb18-447"><a href="#cb18-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-448"><a href="#cb18-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-449"><a href="#cb18-449" aria-hidden="true" tabindex="-1"></a>These forecasts demonstrate how difficult it is to predict stocks values using day-value pairing. However, they also provide a clear estimation of the highest and lowest value points at a given day which can be an invaluable asset. These bounds around the estimated blue line show we should not expect values to go very far above 70 but they also are not likely to drop below 50 anytime soon. Of course, uncertainty grows the farther out our predictions are. Thus, the model must account for the growth in uncertainty over time to manage our risk. This trend is show in the chart below.</span>
<span id="cb18-450"><a href="#cb18-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-453"><a href="#cb18-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-454"><a href="#cb18-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-455"><a href="#cb18-455" aria-hidden="true" tabindex="-1"></a><span class="co"># This is an empty chunk</span></span>
<span id="cb18-456"><a href="#cb18-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-457"><a href="#cb18-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-460"><a href="#cb18-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-461"><a href="#cb18-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-462"><a href="#cb18-462" aria-hidden="true" tabindex="-1"></a>extract <span class="ot">&lt;-</span> fcast0101 <span class="sc">%&gt;%</span> </span>
<span id="cb18-463"><a href="#cb18-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-464"><a href="#cb18-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>))) </span>
<span id="cb18-465"><a href="#cb18-465" aria-hidden="true" tabindex="-1"></a>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> <span class="dv">10</span>),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span></span>
<span id="cb18-466"><a href="#cb18-466" aria-hidden="true" tabindex="-1"></a>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> <span class="dv">10</span>),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span></span>
<span id="cb18-467"><a href="#cb18-467" aria-hidden="true" tabindex="-1"></a>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> <span class="dv">10</span>),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span></span>
<span id="cb18-468"><a href="#cb18-468" aria-hidden="true" tabindex="-1"></a>txtx90 <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb18-469"><a href="#cb18-469" aria-hidden="true" tabindex="-1"></a>txtx80 <span class="ot">&lt;-</span> <span class="dv">74</span></span>
<span id="cb18-470"><a href="#cb18-470" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb18-471"><a href="#cb18-471" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb18-472"><a href="#cb18-472" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb18-473"><a href="#cb18-473" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb18-474"><a href="#cb18-474" aria-hidden="true" tabindex="-1"></a>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span></span>
<span id="cb18-475"><a href="#cb18-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-476"><a href="#cb18-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-479"><a href="#cb18-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-480"><a href="#cb18-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb18-481"><a href="#cb18-481" aria-hidden="true" tabindex="-1"></a>fcast0101 <span class="sc">%&gt;%</span></span>
<span id="cb18-482"><a href="#cb18-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-483"><a href="#cb18-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>)))) <span class="sc">+</span> </span>
<span id="cb18-484"><a href="#cb18-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">fill=</span><span class="st">"forest green"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb18-485"><a href="#cb18-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="st">`</span><span class="at">Lo 80</span><span class="st">`</span>,<span class="at">ymax=</span><span class="st">`</span><span class="at">Hi 80</span><span class="st">`</span>), <span class="at">fill=</span><span class="st">"dark green"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-486"><a href="#cb18-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-487"><a href="#cb18-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-488"><a href="#cb18-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb18-489"><a href="#cb18-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> b1, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-490"><a href="#cb18-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> b2, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-491"><a href="#cb18-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> b3, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-492"><a href="#cb18-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb18-493"><a href="#cb18-493" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b1, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-494"><a href="#cb18-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb18-495"><a href="#cb18-495" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b1, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-496"><a href="#cb18-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb18-497"><a href="#cb18-497" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b2, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-498"><a href="#cb18-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb18-499"><a href="#cb18-499" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b2, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-500"><a href="#cb18-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb18-501"><a href="#cb18-501" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b3, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-502"><a href="#cb18-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb18-503"><a href="#cb18-503" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b3, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-504"><a href="#cb18-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, </span>
<span id="cb18-505"><a href="#cb18-505" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b4, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-506"><a href="#cb18-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, </span>
<span id="cb18-507"><a href="#cb18-507" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> b4, <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>), <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-508"><a href="#cb18-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb18-509"><a href="#cb18-509" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), </span>
<span id="cb18-510"><a href="#cb18-510" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, b1, b2, b3, b4)) <span class="sc">+</span></span>
<span id="cb18-511"><a href="#cb18-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb18-512"><a href="#cb18-512" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fu">min</span>(fcast0101<span class="sc">$</span>lower), <span class="fu">max</span>(fcast0101<span class="sc">$</span>upper)), </span>
<span id="cb18-513"><a href="#cb18-513" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">round</span>(fcast0101<span class="sc">$</span>mean[[<span class="dv">1</span>]], <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb18-514"><a href="#cb18-514" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>), </span>
<span id="cb18-515"><a href="#cb18-515" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb18-516"><a href="#cb18-516" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb18-517"><a href="#cb18-517" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>), </span>
<span id="cb18-518"><a href="#cb18-518" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb18-519"><a href="#cb18-519" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>), </span>
<span id="cb18-520"><a href="#cb18-520" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb18-521"><a href="#cb18-521" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b4),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb18-522"><a href="#cb18-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span><span class="fl">53.9</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"MAPE ="</span>, <span class="fu">signif</span>(mape0101, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb18-523"><a href="#cb18-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>txtx90,<span class="at">y=</span>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">3.50</span>, </span>
<span id="cb18-524"><a href="#cb18-524" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"95% Confidence"</span> ) <span class="sc">+</span> </span>
<span id="cb18-525"><a href="#cb18-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx90, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">4.75</span>, </span>
<span id="cb18-526"><a href="#cb18-526" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx90, </span>
<span id="cb18-527"><a href="#cb18-527" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>,</span>
<span id="cb18-528"><a href="#cb18-528" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb18-529"><a href="#cb18-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx90, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">3</span>, </span>
<span id="cb18-530"><a href="#cb18-530" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx90, </span>
<span id="cb18-531"><a href="#cb18-531" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>,</span>
<span id="cb18-532"><a href="#cb18-532" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span> </span>
<span id="cb18-533"><a href="#cb18-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>txtx80, <span class="at">y=</span>extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx90),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span> <span class="sc">-</span> <span class="fl">3.01</span>, </span>
<span id="cb18-534"><a href="#cb18-534" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"80% Confidence"</span> ) <span class="sc">+</span></span>
<span id="cb18-535"><a href="#cb18-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx80, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">-</span> <span class="fl">1.75</span>, </span>
<span id="cb18-536"><a href="#cb18-536" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx80, </span>
<span id="cb18-537"><a href="#cb18-537" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx80),]<span class="sc">$</span><span class="st">`</span><span class="at">Hi 80</span><span class="st">`</span>,</span>
<span id="cb18-538"><a href="#cb18-538" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb18-539"><a href="#cb18-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> txtx80, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">-</span><span class="fl">3.5</span>, </span>
<span id="cb18-540"><a href="#cb18-540" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> txtx80, </span>
<span id="cb18-541"><a href="#cb18-541" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> txtx80),]<span class="sc">$</span><span class="st">`</span><span class="at">Lo 80</span><span class="st">`</span>,</span>
<span id="cb18-542"><a href="#cb18-542" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb18-543"><a href="#cb18-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>b1 <span class="sc">-</span> <span class="fl">7.05</span>, <span class="at">y=</span><span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">6</span>, </span>
<span id="cb18-544"><a href="#cb18-544" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Day 15:"</span>, <span class="fu">signif</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb18-545"><a href="#cb18-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> b1 <span class="sc">-</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">5</span>, </span>
<span id="cb18-546"><a href="#cb18-546" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b1),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>,</span>
<span id="cb18-547"><a href="#cb18-547" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> b1, </span>
<span id="cb18-548"><a href="#cb18-548" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>)))  <span class="sc">+</span></span>
<span id="cb18-549"><a href="#cb18-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>b2 <span class="sc">-</span> <span class="dv">5</span>, <span class="at">y=</span><span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">9</span>, </span>
<span id="cb18-550"><a href="#cb18-550" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Day 30:"</span>, <span class="fu">signif</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb18-551"><a href="#cb18-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> b2 <span class="sc">-</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">8.0</span>, </span>
<span id="cb18-552"><a href="#cb18-552" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b2),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>,</span>
<span id="cb18-553"><a href="#cb18-553" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> b2, </span>
<span id="cb18-554"><a href="#cb18-554" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>)))  <span class="sc">+</span></span>
<span id="cb18-555"><a href="#cb18-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>,<span class="at">x=</span>b3 <span class="sc">-</span> <span class="dv">10</span>, <span class="at">y=</span><span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="dv">11</span>, </span>
<span id="cb18-556"><a href="#cb18-556" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Day 60:"</span>, <span class="fu">signif</span>(extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="dv">4</span>))) <span class="sc">+</span></span>
<span id="cb18-557"><a href="#cb18-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> b3 <span class="sc">-</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="fu">mean</span>(extract<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">9.75</span>, </span>
<span id="cb18-558"><a href="#cb18-558" aria-hidden="true" tabindex="-1"></a>           <span class="at">yend =</span> extract[<span class="fu">which</span>(extract<span class="sc">$</span>Day <span class="sc">==</span> b3),]<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>,</span>
<span id="cb18-559"><a href="#cb18-559" aria-hidden="true" tabindex="-1"></a>           <span class="at">xend =</span> b3, </span>
<span id="cb18-560"><a href="#cb18-560" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb18-561"><a href="#cb18-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, </span>
<span id="cb18-562"><a href="#cb18-562" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Value Estimation is Less Certain with Time"</span>, </span>
<span id="cb18-563"><a href="#cb18-563" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Stock Market Day-Value Pairs over 100 Days Shows Growth of Uncertainty"</span>) <span class="sc">+</span> </span>
<span id="cb18-564"><a href="#cb18-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb18-565"><a href="#cb18-565" aria-hidden="true" tabindex="-1"></a>                          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb18-566"><a href="#cb18-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-567"><a href="#cb18-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-568"><a href="#cb18-568" aria-hidden="true" tabindex="-1"></a>View the full <span class="co">[</span><span class="ot">source code on GitHub</span><span class="co">](https://github.com/palmorezm/showcase/tree/master/posts/Stock%20Prediction)</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>