arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b2 - 5, y=mean(extract$`Point Forecast`) + 9,
label = paste("Day 30:", signif(extract[which(extract$Day == b2),]$`Point Forecast`, 4))) +
annotate("segment", x = b2 - 4, y = mean(extract$`Point Forecast`) + 8.0,
yend = extract[which(extract$Day == b2),]$`Point Forecast`,
xend = b2,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b3 - 10, y=mean(extract$`Point Forecast`) + 11,
label = paste("Day 60:", signif(extract[which(extract$Day == b3),]$`Point Forecast`, 4))) +
annotate("segment", x = b3 - 10, y = mean(extract$`Point Forecast`) + 9.75,
yend = extract[which(extract$Day == b3),]$`Point Forecast`,
xend = b3,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
theme_minimal()
fcast0101 %>%
as.data.frame() %>%
ggplot(aes(x = seq(1:length(`Hi 95`)))) +
geom_ribbon(aes(ymin=`Lo 95`,ymax=`Hi 95`), fill="forest green", alpha=0.5) +
geom_ribbon(aes(ymin=`Lo 80`,ymax=`Hi 80`), fill="dark green", alpha=0.5) +
geom_line(aes(y = `Hi 95`), color = "grey", size=2, alpha = .5) +
geom_line(aes(y = `Point Forecast`), color = "#000000", size=1, lty = 1, alpha = .5) +
geom_line(aes(y = `Lo 95`), color = "grey", size=2, alpha = .5) +
geom_vline(xintercept = b1, lty = 3) +
geom_vline(xintercept = b2, lty = 3) +
geom_vline(xintercept = b3, lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Hi 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Lo 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Hi 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Lo 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Hi 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Lo 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Hi 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Lo 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Lo 95`), lty = 3) +
scale_x_continuous(expand = c(0, 0),
limits=c(0,100),
breaks = c(0, b1, b2, b3, b4)) +
scale_y_continuous(expand = c(0, 0),
limits=c(min(fcast0101$lower), max(fcast0101$upper)),
breaks = c(round(fcast0101$mean[[1]], digits = 2),
round(extract[which(extract$Day == b1),]$`Hi 95`, 2),
round(extract[which(extract$Day == b1),]$`Lo 95`, 2),
round(extract[which(extract$Day == b2),]$`Hi 95`, 2),
round(extract[which(extract$Day == b2),]$`Lo 95`, 2),
round(extract[which(extract$Day == b3),]$`Hi 95`, 2),
round(extract[which(extract$Day == b3),]$`Lo 95`, 2),
round(extract[which(extract$Day == b4),]$`Hi 95`, 2),
round(extract[which(extract$Day == b4),]$`Lo 95`, 2))) +
annotate("text", x = 7.5, y =55, label = paste0("MAPE =", signif(mape0101, 4))) +
annotate("label",x=txtx90,y=extract[which(extract$Day == txtx90),]$`Point Forecast` + 3.50,
label = "95% Confidence" ) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 4.75,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Hi 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 3,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Lo 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=txtx80, y=extract[which(extract$Day == txtx90),]$`Point Forecast` - 3.01,
label = "80% Confidence" ) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) - 1.75,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Hi 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) -3.5,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Lo 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=b1 - 7.05, y=mean(extract$`Point Forecast`) + 6,
label = paste("Day 15:", signif(extract[which(extract$Day == b1),]$`Point Forecast`, 4))) +
annotate("segment", x = b1 - 7, y = mean(extract$`Point Forecast`) + 5,
yend = extract[which(extract$Day == b1),]$`Point Forecast`,
xend = b1,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b2 - 5, y=mean(extract$`Point Forecast`) + 9,
label = paste("Day 30:", signif(extract[which(extract$Day == b2),]$`Point Forecast`, 4))) +
annotate("segment", x = b2 - 4, y = mean(extract$`Point Forecast`) + 8.0,
yend = extract[which(extract$Day == b2),]$`Point Forecast`,
xend = b2,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b3 - 10, y=mean(extract$`Point Forecast`) + 11,
label = paste("Day 60:", signif(extract[which(extract$Day == b3),]$`Point Forecast`, 4))) +
annotate("segment", x = b3 - 10, y = mean(extract$`Point Forecast`) + 9.75,
yend = extract[which(extract$Day == b3),]$`Point Forecast`,
xend = b3,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
theme_minimal()
fcast0101 %>%
as.data.frame() %>%
ggplot(aes(x = seq(1:length(`Hi 95`)))) +
geom_ribbon(aes(ymin=`Lo 95`,ymax=`Hi 95`), fill="forest green", alpha=0.5) +
geom_ribbon(aes(ymin=`Lo 80`,ymax=`Hi 80`), fill="dark green", alpha=0.5) +
geom_line(aes(y = `Hi 95`), color = "grey", size=2, alpha = .5) +
geom_line(aes(y = `Point Forecast`), color = "#000000", size=1, lty = 1, alpha = .5) +
geom_line(aes(y = `Lo 95`), color = "grey", size=2, alpha = .5) +
geom_vline(xintercept = b1, lty = 3) +
geom_vline(xintercept = b2, lty = 3) +
geom_vline(xintercept = b3, lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Hi 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Lo 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Hi 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Lo 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Hi 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Lo 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Hi 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Lo 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Lo 95`), lty = 3) +
scale_x_continuous(expand = c(0, 0),
limits=c(0,100),
breaks = c(0, b1, b2, b3, b4)) +
scale_y_continuous(expand = c(0, 0),
limits=c(min(fcast0101$lower), max(fcast0101$upper)),
breaks = c(round(fcast0101$mean[[1]], digits = 2),
round(extract[which(extract$Day == b1),]$`Hi 95`, 2),
round(extract[which(extract$Day == b1),]$`Lo 95`, 2),
round(extract[which(extract$Day == b2),]$`Hi 95`, 2),
round(extract[which(extract$Day == b2),]$`Lo 95`, 2),
round(extract[which(extract$Day == b3),]$`Hi 95`, 2),
round(extract[which(extract$Day == b3),]$`Lo 95`, 2),
round(extract[which(extract$Day == b4),]$`Hi 95`, 2),
round(extract[which(extract$Day == b4),]$`Lo 95`, 2))) +
annotate("text", x = 7.5, y =52, label = paste0("MAPE =", signif(mape0101, 4))) +
annotate("label",x=txtx90,y=extract[which(extract$Day == txtx90),]$`Point Forecast` + 3.50,
label = "95% Confidence" ) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 4.75,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Hi 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 3,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Lo 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=txtx80, y=extract[which(extract$Day == txtx90),]$`Point Forecast` - 3.01,
label = "80% Confidence" ) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) - 1.75,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Hi 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) -3.5,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Lo 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=b1 - 7.05, y=mean(extract$`Point Forecast`) + 6,
label = paste("Day 15:", signif(extract[which(extract$Day == b1),]$`Point Forecast`, 4))) +
annotate("segment", x = b1 - 7, y = mean(extract$`Point Forecast`) + 5,
yend = extract[which(extract$Day == b1),]$`Point Forecast`,
xend = b1,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b2 - 5, y=mean(extract$`Point Forecast`) + 9,
label = paste("Day 30:", signif(extract[which(extract$Day == b2),]$`Point Forecast`, 4))) +
annotate("segment", x = b2 - 4, y = mean(extract$`Point Forecast`) + 8.0,
yend = extract[which(extract$Day == b2),]$`Point Forecast`,
xend = b2,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b3 - 10, y=mean(extract$`Point Forecast`) + 11,
label = paste("Day 60:", signif(extract[which(extract$Day == b3),]$`Point Forecast`, 4))) +
annotate("segment", x = b3 - 10, y = mean(extract$`Point Forecast`) + 9.75,
yend = extract[which(extract$Day == b3),]$`Point Forecast`,
xend = b3,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
theme_minimal()
fcast0101 %>%
as.data.frame() %>%
ggplot(aes(x = seq(1:length(`Hi 95`)))) +
geom_ribbon(aes(ymin=`Lo 95`,ymax=`Hi 95`), fill="forest green", alpha=0.5) +
geom_ribbon(aes(ymin=`Lo 80`,ymax=`Hi 80`), fill="dark green", alpha=0.5) +
geom_line(aes(y = `Hi 95`), color = "grey", size=2, alpha = .5) +
geom_line(aes(y = `Point Forecast`), color = "#000000", size=1, lty = 1, alpha = .5) +
geom_line(aes(y = `Lo 95`), color = "grey", size=2, alpha = .5) +
geom_vline(xintercept = b1, lty = 3) +
geom_vline(xintercept = b2, lty = 3) +
geom_vline(xintercept = b3, lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Hi 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Lo 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Hi 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Lo 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Hi 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Lo 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Hi 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Lo 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Lo 95`), lty = 3) +
scale_x_continuous(expand = c(0, 0),
limits=c(0,100),
breaks = c(0, b1, b2, b3, b4)) +
scale_y_continuous(expand = c(0, 0),
limits=c(min(fcast0101$lower), max(fcast0101$upper)),
breaks = c(round(fcast0101$mean[[1]], digits = 2),
round(extract[which(extract$Day == b1),]$`Hi 95`, 2),
round(extract[which(extract$Day == b1),]$`Lo 95`, 2),
round(extract[which(extract$Day == b2),]$`Hi 95`, 2),
round(extract[which(extract$Day == b2),]$`Lo 95`, 2),
round(extract[which(extract$Day == b3),]$`Hi 95`, 2),
round(extract[which(extract$Day == b3),]$`Lo 95`, 2),
round(extract[which(extract$Day == b4),]$`Hi 95`, 2),
round(extract[which(extract$Day == b4),]$`Lo 95`, 2))) +
annotate("text", x = 7.5, y =53.9, label = paste0("MAPE =", signif(mape0101, 4))) +
annotate("label",x=txtx90,y=extract[which(extract$Day == txtx90),]$`Point Forecast` + 3.50,
label = "95% Confidence" ) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 4.75,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Hi 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 3,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Lo 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=txtx80, y=extract[which(extract$Day == txtx90),]$`Point Forecast` - 3.01,
label = "80% Confidence" ) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) - 1.75,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Hi 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) -3.5,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Lo 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=b1 - 7.05, y=mean(extract$`Point Forecast`) + 6,
label = paste("Day 15:", signif(extract[which(extract$Day == b1),]$`Point Forecast`, 4))) +
annotate("segment", x = b1 - 7, y = mean(extract$`Point Forecast`) + 5,
yend = extract[which(extract$Day == b1),]$`Point Forecast`,
xend = b1,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b2 - 5, y=mean(extract$`Point Forecast`) + 9,
label = paste("Day 30:", signif(extract[which(extract$Day == b2),]$`Point Forecast`, 4))) +
annotate("segment", x = b2 - 4, y = mean(extract$`Point Forecast`) + 8.0,
yend = extract[which(extract$Day == b2),]$`Point Forecast`,
xend = b2,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b3 - 10, y=mean(extract$`Point Forecast`) + 11,
label = paste("Day 60:", signif(extract[which(extract$Day == b3),]$`Point Forecast`, 4))) +
annotate("segment", x = b3 - 10, y = mean(extract$`Point Forecast`) + 9.75,
yend = extract[which(extract$Day == b3),]$`Point Forecast`,
xend = b3,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
theme_minimal()
fcast0101 %>%
as.data.frame() %>%
ggplot(aes(x = seq(1:length(`Hi 95`)))) +
geom_ribbon(aes(ymin=`Lo 95`,ymax=`Hi 95`), fill="forest green", alpha=0.5) +
geom_ribbon(aes(ymin=`Lo 80`,ymax=`Hi 80`), fill="dark green", alpha=0.5) +
geom_line(aes(y = `Hi 95`), color = "grey", size=2, alpha = .5) +
geom_line(aes(y = `Point Forecast`), color = "#000000", size=1, lty = 1, alpha = .5) +
geom_line(aes(y = `Lo 95`), color = "grey", size=2, alpha = .5) +
geom_vline(xintercept = b1, lty = 3) +
geom_vline(xintercept = b2, lty = 3) +
geom_vline(xintercept = b3, lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Hi 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Lo 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Hi 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Lo 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Hi 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Lo 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Hi 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Lo 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Lo 95`), lty = 3) +
scale_x_continuous(expand = c(0, 0),
limits=c(0,100),
breaks = c(0, b1, b2, b3, b4)) +
scale_y_continuous(expand = c(0, 0),
limits=c(min(fcast0101$lower), max(fcast0101$upper)),
breaks = c(round(fcast0101$mean[[1]], digits = 2),
round(extract[which(extract$Day == b1),]$`Hi 95`, 2),
round(extract[which(extract$Day == b1),]$`Lo 95`, 2),
round(extract[which(extract$Day == b2),]$`Hi 95`, 2),
round(extract[which(extract$Day == b2),]$`Lo 95`, 2),
round(extract[which(extract$Day == b3),]$`Hi 95`, 2),
round(extract[which(extract$Day == b3),]$`Lo 95`, 2),
round(extract[which(extract$Day == b4),]$`Hi 95`, 2),
round(extract[which(extract$Day == b4),]$`Lo 95`, 2))) +
annotate("text", x = 7.5, y =53.9, label = paste0("MAPE =", signif(mape0101, 4))) +
annotate("label",x=txtx90,y=extract[which(extract$Day == txtx90),]$`Point Forecast` + 3.50,
label = "95% Confidence" ) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 4.75,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Hi 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 3,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Lo 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=txtx80, y=extract[which(extract$Day == txtx90),]$`Point Forecast` - 3.01,
label = "80% Confidence" ) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) - 1.75,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Hi 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) -3.5,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Lo 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=b1 - 7.05, y=mean(extract$`Point Forecast`) + 6,
label = paste("Day 15:", signif(extract[which(extract$Day == b1),]$`Point Forecast`, 4))) +
annotate("segment", x = b1 - 7, y = mean(extract$`Point Forecast`) + 5,
yend = extract[which(extract$Day == b1),]$`Point Forecast`,
xend = b1,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b2 - 5, y=mean(extract$`Point Forecast`) + 9,
label = paste("Day 30:", signif(extract[which(extract$Day == b2),]$`Point Forecast`, 4))) +
annotate("segment", x = b2 - 4, y = mean(extract$`Point Forecast`) + 8.0,
yend = extract[which(extract$Day == b2),]$`Point Forecast`,
xend = b2,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b3 - 10, y=mean(extract$`Point Forecast`) + 11,
label = paste("Day 60:", signif(extract[which(extract$Day == b3),]$`Point Forecast`, 4))) +
annotate("segment", x = b3 - 10, y = mean(extract$`Point Forecast`) + 9.75,
yend = extract[which(extract$Day == b3),]$`Point Forecast`,
xend = b3,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
labs(x = "Day", y = "Value",
title = "Value Estimation is Less Certain with Time",
subtitle = "Stock Market Day-Value Pairs Show High Degree of Uncertainty in Prediction") +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
fcast0101 %>%
as.data.frame() %>%
ggplot(aes(x = seq(1:length(`Hi 95`)))) +
geom_ribbon(aes(ymin=`Lo 95`,ymax=`Hi 95`), fill="forest green", alpha=0.5) +
geom_ribbon(aes(ymin=`Lo 80`,ymax=`Hi 80`), fill="dark green", alpha=0.5) +
geom_line(aes(y = `Hi 95`), color = "grey", size=2, alpha = .5) +
geom_line(aes(y = `Point Forecast`), color = "#000000", size=1, lty = 1, alpha = .5) +
geom_line(aes(y = `Lo 95`), color = "grey", size=2, alpha = .5) +
geom_vline(xintercept = b1, lty = 3) +
geom_vline(xintercept = b2, lty = 3) +
geom_vline(xintercept = b3, lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Hi 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Lo 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Hi 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Lo 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Hi 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Lo 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Hi 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Lo 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Lo 95`), lty = 3) +
scale_x_continuous(expand = c(0, 0),
limits=c(0,100),
breaks = c(0, b1, b2, b3, b4)) +
scale_y_continuous(expand = c(0, 0),
limits=c(min(fcast0101$lower), max(fcast0101$upper)),
breaks = c(round(fcast0101$mean[[1]], digits = 2),
round(extract[which(extract$Day == b1),]$`Hi 95`, 2),
round(extract[which(extract$Day == b1),]$`Lo 95`, 2),
round(extract[which(extract$Day == b2),]$`Hi 95`, 2),
round(extract[which(extract$Day == b2),]$`Lo 95`, 2),
round(extract[which(extract$Day == b3),]$`Hi 95`, 2),
round(extract[which(extract$Day == b3),]$`Lo 95`, 2),
round(extract[which(extract$Day == b4),]$`Hi 95`, 2),
round(extract[which(extract$Day == b4),]$`Lo 95`, 2))) +
annotate("text", x = 7.5, y =53.9, label = paste0("MAPE =", signif(mape0101, 4))) +
annotate("label",x=txtx90,y=extract[which(extract$Day == txtx90),]$`Point Forecast` + 3.50,
label = "95% Confidence" ) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 4.75,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Hi 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 3,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Lo 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=txtx80, y=extract[which(extract$Day == txtx90),]$`Point Forecast` - 3.01,
label = "80% Confidence" ) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) - 1.75,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Hi 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) -3.5,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Lo 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=b1 - 7.05, y=mean(extract$`Point Forecast`) + 6,
label = paste("Day 15:", signif(extract[which(extract$Day == b1),]$`Point Forecast`, 4))) +
annotate("segment", x = b1 - 7, y = mean(extract$`Point Forecast`) + 5,
yend = extract[which(extract$Day == b1),]$`Point Forecast`,
xend = b1,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b2 - 5, y=mean(extract$`Point Forecast`) + 9,
label = paste("Day 30:", signif(extract[which(extract$Day == b2),]$`Point Forecast`, 4))) +
annotate("segment", x = b2 - 4, y = mean(extract$`Point Forecast`) + 8.0,
yend = extract[which(extract$Day == b2),]$`Point Forecast`,
xend = b2,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b3 - 10, y=mean(extract$`Point Forecast`) + 11,
label = paste("Day 60:", signif(extract[which(extract$Day == b3),]$`Point Forecast`, 4))) +
annotate("segment", x = b3 - 10, y = mean(extract$`Point Forecast`) + 9.75,
yend = extract[which(extract$Day == b3),]$`Point Forecast`,
xend = b3,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
labs(x = "Day", y = "Value",
title = "Value Estimation is Less Certain with Time",
subtitle = "Stock Market Day-Value Pairs Show Growth of Uncertainty in Prediction over 100 Days") +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
fcast0101 %>%
as.data.frame() %>%
ggplot(aes(x = seq(1:length(`Hi 95`)))) +
geom_ribbon(aes(ymin=`Lo 95`,ymax=`Hi 95`), fill="forest green", alpha=0.5) +
geom_ribbon(aes(ymin=`Lo 80`,ymax=`Hi 80`), fill="dark green", alpha=0.5) +
geom_line(aes(y = `Hi 95`), color = "grey", size=2, alpha = .5) +
geom_line(aes(y = `Point Forecast`), color = "#000000", size=1, lty = 1, alpha = .5) +
geom_line(aes(y = `Lo 95`), color = "grey", size=2, alpha = .5) +
geom_vline(xintercept = b1, lty = 3) +
geom_vline(xintercept = b2, lty = 3) +
geom_vline(xintercept = b3, lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Hi 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b1),]$`Lo 95`,
xend = b1, yend = extract[which(extract$Day == b1),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Hi 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b2),]$`Lo 95`,
xend = b2, yend = extract[which(extract$Day == b2),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Hi 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b3),]$`Lo 95`,
xend = b3, yend = extract[which(extract$Day == b3),]$`Lo 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Hi 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Hi 95`), lty = 3) +
geom_segment(aes(x = 0, y = extract[which(extract$Day == b4),]$`Lo 95`,
xend = b4, yend = extract[which(extract$Day == b4),]$`Lo 95`), lty = 3) +
scale_x_continuous(expand = c(0, 0),
limits=c(0,100),
breaks = c(0, b1, b2, b3, b4)) +
scale_y_continuous(expand = c(0, 0),
limits=c(min(fcast0101$lower), max(fcast0101$upper)),
breaks = c(round(fcast0101$mean[[1]], digits = 2),
round(extract[which(extract$Day == b1),]$`Hi 95`, 2),
round(extract[which(extract$Day == b1),]$`Lo 95`, 2),
round(extract[which(extract$Day == b2),]$`Hi 95`, 2),
round(extract[which(extract$Day == b2),]$`Lo 95`, 2),
round(extract[which(extract$Day == b3),]$`Hi 95`, 2),
round(extract[which(extract$Day == b3),]$`Lo 95`, 2),
round(extract[which(extract$Day == b4),]$`Hi 95`, 2),
round(extract[which(extract$Day == b4),]$`Lo 95`, 2))) +
annotate("text", x = 7.5, y =53.9, label = paste0("MAPE =", signif(mape0101, 4))) +
annotate("label",x=txtx90,y=extract[which(extract$Day == txtx90),]$`Point Forecast` + 3.50,
label = "95% Confidence" ) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 4.75,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Hi 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx90, y = mean(extract$`Point Forecast`) + 3,
xend = txtx90,
yend = extract[which(extract$Day == txtx90),]$`Lo 95`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=txtx80, y=extract[which(extract$Day == txtx90),]$`Point Forecast` - 3.01,
label = "80% Confidence" ) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) - 1.75,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Hi 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("segment", x = txtx80, y = mean(extract$`Point Forecast`) -3.5,
xend = txtx80,
yend = extract[which(extract$Day == txtx80),]$`Lo 80`,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
annotate("label",x=b1 - 7.05, y=mean(extract$`Point Forecast`) + 6,
label = paste("Day 15:", signif(extract[which(extract$Day == b1),]$`Point Forecast`, 4))) +
annotate("segment", x = b1 - 7, y = mean(extract$`Point Forecast`) + 5,
yend = extract[which(extract$Day == b1),]$`Point Forecast`,
xend = b1,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b2 - 5, y=mean(extract$`Point Forecast`) + 9,
label = paste("Day 30:", signif(extract[which(extract$Day == b2),]$`Point Forecast`, 4))) +
annotate("segment", x = b2 - 4, y = mean(extract$`Point Forecast`) + 8.0,
yend = extract[which(extract$Day == b2),]$`Point Forecast`,
xend = b2,
arrow = arrow(type = "closed", length = unit(0.02, "npc")))  +
annotate("label",x=b3 - 10, y=mean(extract$`Point Forecast`) + 11,
label = paste("Day 60:", signif(extract[which(extract$Day == b3),]$`Point Forecast`, 4))) +
annotate("segment", x = b3 - 10, y = mean(extract$`Point Forecast`) + 9.75,
yend = extract[which(extract$Day == b3),]$`Point Forecast`,
xend = b3,
arrow = arrow(type = "closed", length = unit(0.02, "npc"))) +
labs(x = "Day", y = "Value",
title = "Value Estimation is Less Certain with Time",
subtitle = "Stock Market Day-Value Pairs over 100 Days Shows Growth of Uncertainty") +
theme_minimal() + theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
